<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.0e7161a34b6d670eb922.css" id="gatsby-global-css">body{background:#fff}</style><meta name="generator" content="Gatsby 3.0.1"/><link as="script" rel="preload" href="/webpack-runtime-187f5339a8a2460030f4.js"/><link as="script" rel="preload" href="/framework-a40b623ed1dc54ee5f47.js"/><link as="script" rel="preload" href="/app-f7c372e715da09534e99.js"/><link as="script" rel="preload" href="/component---src-pages-sslskimmer-js-9bcd19e60bd9e720a9bd.js"/><link as="fetch" rel="preload" href="/page-data/sslskimmer/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><head><title>SSLskimmer</title></head><body><div><h1>SSLskimmer</h1><div><p>In 2009, Moxie Marlinspike released an attack by the name of <a href="https://moxie.org/software/sslstrip/">SSLstrip</a>. It allows man-in-the-middle attackers to strip the security from HTTPS server responses, forwarding naked HTTP to the victim.  If the victim does not notice that they are no longer using a secure connection they are likely to submit login details and other sensitive information to stripped pages.  The attacker reads the information before forwarding it to the server.  I find this attack to be intriguing because it lies at the intersection of three different weak points in internet security: TLS certificates, browser warnings, and user education.</p><p>I gave a <a href="https://docs.google.com/presentation/d/1fENuA1fRX_w9yTrOpYyWOPsPKNkd423y9IxjGN0Wo0s/edit?usp=sharing">presentation</a> on the most current methods of performing the attack, particularly Leonardo Nve Egea&#x27;s <a href="https://github.com/byt3bl33d3r/sslstrip2">SSLstrip+</a>. This version uses a spoofed DNS server to avoid failing to HTTP Strict Transport Security (HSTS) preloading by browsers, but does not defeat HTTP Public Key Pinning (HPKP).</p><p>While HPKP seems to be an effective countermeasure for the time being, its low adoption rate relative to HSTS leaves many connections open to attack.  There are also several browsers that have lagged behind the adoption curve for HSTS.  These connections are all vulnerable; however, they are protected via herd immunity.  Users of non-vulnerable browsers are likely to raise concerns when presented with obvious signs of MITM attacks such as the large error messages and warning screens that most browsers provide.  This results in a situation of herd immunity; the uninoculated users are protected from broad-spectrum attacks by the immune.</p><p>I propose a method for circumventing this crowd-based defence.  Lee Brotherston has demonstrated the viability of <a href="https://github.com/LeeBrotherston/tls-fingerprinting">TLS fingerprinting,</a> where we examine Client Hello messages to determine traits of the system that sent each message.  By checking the TLS version, available ciphersuites, and ordering of available ciphersuites against a prebuilt database of known Client Hello traits, we can determine which variety of browser sent the traffic we have intercepted.  Armed with this information it is possible to selectively attack only users who are known to be vulnerable while we fly under the radar of everyone who isn&#x27;t, thereby resurrecting an attack previously considered to be obsolete.</p><p>I&#x27;ve put together a <a href="https://github.com/adam-imeson/sslskimmer">git repo</a> of relevant tools and instructions.  I was able to selectively target individual devices after gaining information on their TLS configurations.  Primary recommendation: enforce a canonical ordering of TLS ciphersuites in Client Hellos.  Secondary recommendation: avoid relying on herd immunity as a defence against attacks.</p></div></div></body></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/sslskimmer/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-5792f93f6c385609b8b0.js"],"app":["/app-f7c372e715da09534e99.js"],"component---src-pages-index-js":["/component---src-pages-index-js-af1d2f43556f58aa10e0.js"],"component---src-pages-sslskimmer-js":["/component---src-pages-sslskimmer-js-9bcd19e60bd9e720a9bd.js"]};/*]]>*/</script><script src="/polyfill-5792f93f6c385609b8b0.js" nomodule=""></script><script src="/component---src-pages-sslskimmer-js-9bcd19e60bd9e720a9bd.js" async=""></script><script src="/app-f7c372e715da09534e99.js" async=""></script><script src="/framework-a40b623ed1dc54ee5f47.js" async=""></script><script src="/webpack-runtime-187f5339a8a2460030f4.js" async=""></script></body></html>